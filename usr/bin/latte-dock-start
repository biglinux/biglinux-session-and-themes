#!/bin/bash

ENABLE_LATTE="$(cat ~/.config/enable_latte)"

rm -f ~/.config/autostart/org.kde.latte-dock.desktop

if [ "$(qdbus org.kde.ksmserver /KSMServer org.kde.KSMServerInterface.isShuttingDown)" = "false" ]; then

    if [ "$(cat "$HOME/.big_performance")" != "0" ] && [ "$(cat "$HOME/.big_performance")" != "" ]; then
        if [ "$ENABLE_LATTE" = "1" ]; then
            qdbus org.kde.lattedock /Latte org.kde.LatteDock.quitApplication
            QT_QUICK_BACKEND=software latte-dock 
        fi
else
        if [ "$ENABLE_LATTE" = "1" ]; then
            qdbus org.kde.lattedock /Latte org.kde.LatteDock.quitApplication
            QT_QUICK_BACKEND="" QSG_RENDER_LOOP="" latte-dock
        fi
    fi

fi

sleep 1
